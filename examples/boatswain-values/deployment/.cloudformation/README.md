# AWS CloudFormation Templates

```yaml
# ebs-hydra-mysql.yaml

AWSTemplateFormatVersion: 2010-09-09
Description: >-
  App: Hydra DB
  Create EBS Volume from a snapshot for the Hydra MySQL database. 
Metadata:
  Name: ebs-hydra-mydql
Resources:
  EBSVolume:
    Type: "AWS::EC2::Volume"
    Properties:
      AvailabilityZone: us-west-2a
      Encrypted: false
      Size: 100
      Tags:
        - Key: datasource
          Value: hydra
      VolumeType: standard
      SnapshotId: snap-12345
Outputs:
  AwsEbsVolumeId:
    Description: AwsEbsVolumeId
    Value: !Ref EBSVolume
 ```

Boatswain has the ability to provision staging environments with AWS services generated via CloudFormation templates as CloudFormation stacks. `ebs-hydra-mysql.yaml` will be called in `boatswain stage push hydra branch-name`. This template will spin up an EBS volume from the snapshot `snap-12345` defined in the template. The output of this stack, defined in the `Outputs` section of the template, will be carried over to the autogenerated values files generated from the `boatswain stage push` command. For instance, the output below will take the EBS volume ID generated from the CloudFormation stack and drop it in the values files as `.Values.Boatswain.CloudFormationValues.AwsEbsVolumeId`. These outputs are fully customizable. 

TODO: write section on how to include a CloudFormation template as part of the service map definition

```yaml
Outputs:
  AwsEbsVolumeId:
    Description: AwsEbsVolumeId
    Value: !Ref EBSVolume
```

For more information on CloudFormation Templates, [visit the CloudFormation template page](https://aws.amazon.com/cloudformation/aws-cloudformation-templates/)
